---
layout: post
title: The Final Bugs
date: '2007-05-22T01:14:00.000-07:00'
author: headius
tags:
- jruby
modified_time: '2011-01-25T21:44:32.865-08:00'
blogger_id: tag:blogger.com,1999:blog-4704664917418794835.post-3907929259206269162
blogger_orig_url: http://blog.headius.com/2007/05/final-bugs.html
---

We're within weeks of a final JRuby 1.0. We've pared down the <a href="http://jira.codehaus.org/secure/IssueNavigator.jspa?reset=true&mode=hide&amp;sorter/order=DESC&sorter/field=priority&amp;resolution=-1&pid=11295&amp;fixfor=13502">bugs that we  think we can or must fix for 1.0</a> and this email is a summary of the ones  we need help with. So whatever time you can spare, please have a look  and help resolve these.<br /><br />In order of decreasing priority in JIRA:<br /><br /><a href="http://jira.codehaus.org/browse/JRUBY-820">JRUBY-820</a>: Net::HTTP.get behaves differently form MRI, failing to get  UTF8 properly<br />-and-<br /><a href="http://jira.codehaus.org/browse/JRUBY-828">JRUBY-828</a>: UTF-8 regular expressions aren't working<br /><br />I believe these are both largely the same problem, and it's probably the  most visible remaining bug we need to fix. Regular expressions in JRuby  currently do not work well with unicode strings, both as incoming match  strings and as the regular expression strings themselves. REXML uses /u  regular expressions, which is why I believe these issues are closely  related. Wes Nakamura has commented that he's looking into 828, but more  eyes will help ensure this is fixed.<br /><span style="font-weight: bold;">I believe these are true blocking bugs for 1.0, and I'm not comfortable  doing a release if they are not resolved.</span><br /><br /><a href="http://jira.codehaus.org/browse/JRUBY-971">JRUBY-971</a>: Make it clear which Java method maps to each equality method<br /><br />I think we have subtle equality bugs remaining largely because we don't  use a consistent naming convention for the Java implementations of Ruby  methods like ==, ===, eql? and so on. We should make a quick sweep  through the system and make sure all core JRuby code is using the same  Java method names for all of these, and binding them in the same way.  Note: This is actually the cause of some set_trace_func bugs, since the  default === impl should actually invoke ==, causing trace events for both.<br /><br /><a href="http://jira.codehaus.org/browse/JRUBY-969">JRUBY-969</a>: Add rake and rspec to standard JRuby distribution for 1.0<br /><br />We have decided to ship both Rake and RSpec with JRuby 1.0, since they  are both well-accepted and widely used (moreso for Rake, but RSpec has  gained a lot of acceptance the past year). But the mechanism of  including them is unclear. I do not want to commit installed gems to  SVN; I would prefer to just install them as needed for testing and when  building the JRuby distribution. Thoughts?<br /><br /><a href="http://jira.codehaus.org/browse/JRUBY-672">JRUBY-672</a>: java.lang.Class representation of Ruby class not retrievable<br /><br />This bug is basically just looking for a way to get at the actual  java.lang.Class representing a Ruby-based extension of a Java class.  There may have been an API added with Bill's work, or this could be  simple to add.<br /><br /><a href="http://jira.codehaus.org/browse/JRUBY-914">JRUBY-914</a>: JRuby's BigDecimal needs to round<br /><br />Stu submitted a patch for this, but it unfortunately depends on behavior  only present in Java 5 and higher. Since most of us are pretty  unfamiliar with BigDecimal, we don't know of a good workaround to  support it correctly in Java 1.4.<br /><br /><a href="http://jira.codehaus.org/browse/JRUBY-822">JRUBY-822</a>: jruby fails to report process exit status correctly<br /><br />I think Nick may have a grip on this one, but if anyone can offer  suggestions as to why the exit codes are apparently shifted in this way,  please let us know.<br /><br /><a href="http://jira.codehaus.org/browse/JRUBY-966">JRUBY-966</a>: Various issues with LocalJumpError not being created early enough<br />-and-<br /><a href="http://jira.codehaus.org/browse/JRUBY-767">JRUBY-767</a>: next in an eval should produce a local jump error<br /><br />These are likely going to be up to Tom and I since they involve pretty  deep runtime/interpreter work. But we're also looking for any remaining  known issues with LocalJumpError/JumpException that are still out there.  I believe we've fixed all such externally-reported issues at the moment.<br /><br /><a href="http://jira.codehaus.org/browse/JRUBY-888">JRUBY-888</a>: Make regular distro/build create the all-in-one jar by default<br /><br />We waffle back and forth on this. What's the answer? An all-in-one jar  by default, or on request?<br /><br /><a href="http://jira.codehaus.org/browse/JRUBY-873">JRUBY-873</a>: ant test thread tests sometimes run forever<br /><br />I managed to get a trace on this one. It appears that some of the tests  cause a deadlock between stopping a thread and other operations. But I  don't believe anyone's seen it in normal execution yet (or at least  nobody's reported it). I'm probably the only one familiar enough with  the threading subsystem to fix it, but I'd like to know if anyone's seen  other issues.<br /><br /><a href="http://jira.codehaus.org/browse/JRUBY-98">JRUBY-98</a>: allow "/" as absolute path in Windows<br />-and-<br /><a href="http://jira.codehaus.org/browse/JRUBY-36">JRUBY-36</a>: Dir['...'] incompatibilities between Ruby and accross platforms<br />-and-<br /><a href="http://jira.codehaus.org/browse/JRUBY-61">JRUBY-61</a>: IO CRLF compatibility with cruby on Windows<br />-and-<br /><a href="http://jira.codehaus.org/browse/JRUBY-644">JRUBY-644</a>: Windows line delimiter (\r\n) cause position errors<br /><br />These blasted Windows pathing and newline bugs just seem to hang on  forever. Nobody wants to fix them. There must be someone out there that  can help resolve these, yes?<br /><br /><a href="http://jira.codehaus.org/browse/JRUBY-884">JRUBY-884</a>: Create and consolidate extension and non-standard options<br /><br />There are a number of configuration options for JRuby. Some have their  own flags, like -O to disable ObjectSpace and -C to force compilation of  a target script. But many others are only configurable via Java system  properties. What we really could use from the community is some idea  which settings are worth adding special flags for. We can handle the  rest. My personal opinion is that the new -J flag that allows passing  flags to the JVM is actually enough.<br /><br />By my estimation, the rest of the bugs are either almost done or are  trivial enough they could be punted to a post 1.0 release. But if we can  get these issues knocked down soon (starting with those top couple), 1.0  is going to be an extremely solid release.