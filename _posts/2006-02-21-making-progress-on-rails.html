---
layout: post
title: Making Progress on Rails
date: '2006-02-21T09:20:00.000-08:00'
author: headius
tags: 
modified_time: '2011-01-25T21:44:34.966-08:00'
blogger_id: tag:blogger.com,1999:blog-4704664917418794835.post-1012660351091547645
blogger_orig_url: http://blog.headius.com/2006/02/making-progress-on-rails.html
---

I've been making good progress on my end of the Rails-on-JRuby work. I have been focusing on getting the "generate" script working, and as a result fixing multiple bugs and minor issues as they come up. Here's an update.<br /><br />The most recent issue, now apparently mostly fixed, involved evaluating a Ruby script from within a block. The JRuby parser was not wired to understand parsing from within scopes other than the top-level Object, and so it declared and defined certain variables incorrectly. I modified the parser to allow specifying that it will run from within a block, and the issues have been remedied.<br /><br />With this fix, here's a rough description of the progress of the generate script:<br /><ul><li>Execution proceeds into the initializer (vendor/rails/railties/lib/initializer.rb). In the scenario I'm executing (generate script with no parameters) the process method is eventually invoked.</li><li>The load path is set (Initializer#set_load_path) without any issues</li><li>Connection adapters are set (Initializer#set_connection_adapters)</li><li>All frameworks are required in (Initializer#require_frameworks). This was where most of the failures and fixes came into play, but it now executes successfully.</li><li>The current environment is loaded (Initializer#load_environment). I'm using the default environment right now.</li><li>Initialization of the database begins to run, but appears to get stuck in some infinite loop during YAML parsing of the default database.yml file. I have not investigated this issue yet, and disabled database initialization to continue some testing.</li><li>The logger initializes without any issues (Initializer#initialize_logger)</li><li>The framework logging and views are initialized (Initializer#initializer_framework_logger and initialize_framework_view)</li></ul><br />At this point, the next step is initializing routing (presumably request routing; I'm not any sort of Rails expert yet). This fails with what appears to be some scoping issues, and I have not gotten further at the moment.<br /><br />Tom Enebo, the other main JRuby developer, is also making progress on actually running Rails in the simplest of deployment scenarios. He's currently beefing up our Socket implementation so that WeBRICK will run correctly. The current sticking point is our less-than-great support for Ruby's IO; namely, we do not support select correctly (or perhaps at all).<br /><br />I think we've made great progress on both fronts, despite ongoing issues. It's very heartening that for the generate script all the libraries are required successfully and several subsystems initialize without any problems. There's still quite a bit of work to be done, but we're definitely getting there. I'll post more updates as they come in!