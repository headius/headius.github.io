---
layout: post
title: ActiveRecord-JDBC 0.2.1 Released!
date: '2006-09-06T14:43:00.000-07:00'
author: headius
tags: 
modified_time: '2011-01-25T21:44:34.027-08:00'
blogger_id: tag:blogger.com,1999:blog-4704664917418794835.post-9165274971045544459
blogger_orig_url: http://blog.headius.com/2006/09/activerecord-jdbc-021-released.html
---

I told you it would only be a couple days!<br /><br /><a href="http://ola-bini.blogspot.com/2006/09/activerecord-jdbc-020.html">ActiveRecord 0.2 has been released</a>. (It's actually 0.2.1 because of a minor Gem glitch)<br /><br />Ola wraps it up in the link above, but for the record it supports normal AR operations and basic migrations for the following databases:<br /><ul><li>MySQL</li><li>PostgreSQL</li><li>Oracle</li><li>HSQLDB<br /></li><li>Microsoft SQL Server (except for change_column_default)</li><li>DB2 (except change_column, change_column_default, rename_column, remove_column,<br />add_index, remove_index and rename_table)</li><li>Derby (except change_column, change_column_default, remove_column, rename_column)</li><li>FireBird (except change_column_default and rename_column)</li></ul>Whew! And we really only started getting migrations and additional databases into the mix a week or two ago. Things go very fast when you have JDBC to handle all the heavy lifting!<br /><br />I'm going to demo the AWDwR2 Depot app running on top of MySQL at Rails, and probably demonstrate one of the other databases Rails doesn't normally support as well (Derby perhaps? or SQL Server if I can get Parallels up before presenting?)<br /><br /><span style="font-weight: bold;">Usage</span><br /><br />Ola has a Derby walkthrough with some unusual typos [<span style="font-style:italic;">Update: my mistake, he symlinked stuff like "gem" to "jem" to avoid collisions with MRI</span>], but here's my walkthrough for MySQL in ultra-condensed form:<br /><ol><li>Install JRuby from trunk or my branch</li><li>Build it (not necessary once we get another release out)<pre>ant clean jar</pre></li><li>Set up env vars for JRuby<pre>export JRUBY_HOME=[jruby dir]<br />export PATH=[jruby dir]/bin:$PATH</pre></li><li>Install Rails<pre>gem install rails -y --no-rdoc --no-ri</pre></li><li>Install ActiveRecord-JDBC<pre>gem install activerecord-jdbc --no-rdoc --no-ri</pre></li><li>Generate a Rails App<pre>rails ~/testapp</pre></li><li>Go to the app<pre>cd ~/testapp</pre></li><li>Modify database.yml<pre>development:<br /> adapter: <span style="font-weight: bold;">jdbc</span><br /> <span style="font-weight: bold;">driver: com.mysql.jdbc.Driver</span><br /> <span style="font-weight: bold;">url: jdbc:mysql://localhost/testapp_development</span><br /> username: ...<br /> password: ...</pre></li><li>Modify environment.rb:<pre>require File.join(File.dirname(__FILE__), 'boot')<br /><span style="font-weight: bold;">require 'active_record/connection_adapters/jdbc_adapter'</span></pre></li><li>Add driver to CLASSPATH<pre>export CLASSPATH=$CLASSPATH:mysql.jar</pre></li><li>Create a testapp_development database, grants for testapp user, and widgets table in MySQL (use migrations if you like)</li><li>Scaffold Widgets CRUD<pre>jruby script/generate scaffold widget</pre></li><li>Start up the server<pre>jruby script/server</pre></li></ol>And that's about it. You've got a scaffolded widget page running in JRuby over JDBC to MySQL.<br /><br />Pretty neat, eh?<br /><br /><span style="font-weight: bold;">Troubleshooting</span><br /><ul><li>ActiveRecord-JDBC does not install: I had some trouble myself; I think something's up with either RubyForge or with our released gem. You can always <a href="http://rubyforge.org/frs/?group_id=2014&release_id=6819">download ActiveRecord-JDBC</a> and install it locally, of course.<br /></li><li><span style="font-weight: bold;">scaffold fails with an error about "nonexistent jdbc adapter":</span> Ensure you've added the require line to environment.rb (hopefully this will be unnecessary in the future)</li><li><span style="font-weight: bold;">scaffold and script/server terminate without running:</span> Make sure you've successfully installed the ActiveRecord-JDBC gem. The additional require in environment.rb causes Rails scripts to die silently if there are any errors.</li><li><span style="font-weight: bold;">scaffold fails with the error "cannot convert NilClass into String":</span> Make sure you've correctly specified the driver and url lines in database.yml<br /></li></ul><span style="font-weight: bold;">What's Next</span><br /><br />We're going to continue adding database support, especially if you folks can contribute migrations impls for your database of choice. It's fun and easy!<br /><br />We've also got a patch under discussion to allow adding JDBC database jars to [RAILS_ROOT]/lib and have the driver pick them up automatically. This could obviously be extended to Rails at large for service client jars, persistence framework jars, and so on. No more CLASSPATH manipulation!<br /><br />We're hoping to get the Rails guys to include "jdbc" in the list of supported adapters out-of-the-box, so that environment.rb require is not necessary.<br /><br />We're also going to see if there's a way to abstract out all the DDL code in core Rails, so we can all benefit from the same code.