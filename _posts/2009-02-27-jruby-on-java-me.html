---
layout: post
title: JRuby on Java ME
date: '2009-02-27T02:25:00.000-08:00'
author: headius
tags: 
modified_time: '2011-01-25T21:44:31.073-08:00'
blogger_id: tag:blogger.com,1999:blog-4704664917418794835.post-6590018528719148069
blogger_orig_url: http://blog.headius.com/2009/02/jruby-on-java-me.html
---

A number of folks have asked us over the years whether JRuby could run on a Java ME-enabled device. I've always said I believed it would be possible with enough trimming. Strip out all the libraries that ME doesn't support, and you should be left with a runnable "core" of JRuby. Roy Ben Hayun, formerly of Symbian and (I believe) now working at Sun, actually proved it possible but difficult back in 2006 with his <a href="http://blog.headius.com/2007/11/jruby-on-me-devices.html">JRubyME project</a>, a stripped down JRuby 0.9.8. But that didn't have compiler support, and we were still dog slow in 2006. Has JRuby, with two years of work behind it, grown too complex to run on an embedded device? Is the <a href="http://blog.headius.com/2007/11/jruby-on-me-devices.html">Rhodes project</a> right when they say JRuby is too large for this to work?<br /><br />Tony Arcieri, of Revactor fame, put a bug in my ear about Java ME again this week. He's interested in running Ruby on a device hosting the <a href="http://java.sun.com/javame/technology/cdc/">Connected Device Configuration (CDC)</a> level of Java ME. Specifically, the device in question supports CDC plus the APIs included in the <a href="http://java.sun.com/javame/reference/apis/jsr217/">Personal Basis Profile (PBP)</a>. CDC is probably about the smallest ME profile JRuby could reasonably run in, since anything lower (like CLDC, the Connected Limited Device Configuration) and you're reduced to the most basic collections, IO, and utility APIs.<br /><br />So, I'm happy to announce that the <a href="http://github.com/headius/jruby-cdc/tree/master">JRuby CDC Project</a> has spawned out of the JRuby codebase.<br /><br />Here's what it looks like running, using <a href="http://java.sun.com/javame/downloads/index.jsp">Sun's reference implementation of CDC+PBP</a>:<br /><pre>~/cdc/Optimized_nosym$ bin/cvm -classpath ../jruby.jar org.jruby.Main -X-C -e "[1,2,3].each {|i| puts i}"<br />1<br />2<br />3</pre><br />The "cvm" is Sun's reference implementation of an embedded JVM, and this particular package includes the PBP level APIs as well. The jruby.jar here is the one I've stripped in the jruby-cdc project, but with the additional step of <a href="http://retroweaver.sourceforge.net/">retroweaving</a> it back to Java 1.3-compatible bytecode.<br /><br />My intention with this is to get it running with a base set of Ruby classes but with Java integration still functional. That will allow most basic Ruby scripts to work while providing access to the rest of the Java APIs for bits I had to rip out (like IO APIs)<br /><br />It's only running interpreted right now, just like the Android version of JRuby, but as in that case I expect most people will want to precompile Ruby code and ship it all as one unit.<br /><br />Why bother? Well, there are still a lot of Java ME devices out there. And while the device you carry in your pocket may be growing beyond Java ME, the set-top box or Blu-Ray player in your living room is just starting to reach that level. The technology is still sound, if perhaps less obvious than an iPhone or Android. And hey, we want "Ruby everywhere," don't we?<br /><br />Where do we go from here? I think this and <a href="http://blog.headius.com/2009/02/ruboto-is-your-friend.html">Ruboto</a> are proof that damn near anything is possible with JRuby. It really only took me a couple days of trimming to get this far. Fully supporting Android in Ruboto will not take long, and other "mini ruby" profiles are possible for other platforms and use cases as well. It just takes a little imagination, and maybe a few late-night hacking sessions.<br /><br />Now...for my next trick...