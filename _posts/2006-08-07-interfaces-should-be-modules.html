---
layout: post
title: Interfaces Should Be Modules
date: '2006-08-07T22:05:00.000-07:00'
author: headius
tags: 
modified_time: '2011-01-25T21:44:34.281-08:00'
blogger_id: tag:blogger.com,1999:blog-4704664917418794835.post-741558858676417640
blogger_orig_url: http://blog.headius.com/2006/08/interfaces-should-be-modules.html
---

Currently, in order to implement a Java interface in JRuby, you extend from it like so:<br /><pre>require 'java'<br /><br />include_class "java.awt.event.ActionListener"<br /><br />class MyActionListener &lt; ActionListener<br /> def actionPerformed(event)<br />   puts event<br /> end<br />end</pre><br />While documenting a JRUBY-66 workaround and thinking about a longterm fix, it hit me like a diamond bullet through my forehead: interfaces should be treated like modules.<br /><br />My justification:<br /><br /><ol><li> You can include many modules, but only extend one class...just like interfaces. Currently in JRuby you can only implement one interface, which is stupid.</li><li>Modules imply a particular set of behaviors not specific to a given class hierarchy...just like interfaces.</li><li>Ruby implementations of Java interfaces can't extend any other classes; you can't both extend Array and implement Collection, if that were your goal.</li><li>Ruby implementations of Java interfaces have bugs when defining initialize, since they don't really just implement that interface...they extend one of our JavaSupport proxies.</li></ol>Item #1 will be of particular importance as we start using JRuby more and more to implement Java services. In my opinion, this is an unacceptable limitation on JRuby's Java integration capabilities.<br /><br />Item #3 limits your ability to re-open core Ruby classes and add new Java interfaces to them, something that might greatly simplify mapping Ruby types to Java-land.<br /><br />Item #4 is the cause of JRUBY-66, since we need to make sure the proxy's initializer is called.<br /><br />In our defence, we inherited much of this Java integration behavior from the original project owners; however I think mapping interfaces to modules allows for much more powerful and uniform Java integration support.<br /><br />I know it would be a fairly significant change to make Java interfaces<br />act like modules, but it seems much more logical to me. It's also primarily a <span style="font-weight: bold;">new</span> feature we could phase in, with the &lt; syntax continuing to work for old style interface implementation.<br /><br />Thoughts?<br /><pre># yes, I know encapsulation would be better...this is just an example<br />...<br />include_class "javax.swing.JButton"<br /><br />class MyActionRecorder &lt; Array<br />include ActionListener<br /><br />def actionPerformed(event)<br />  self &lt;&lt; event<br />end<br />end</pre>