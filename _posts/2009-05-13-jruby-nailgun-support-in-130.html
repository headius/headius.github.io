---
layout: post
title: JRuby Nailgun Support in 1.3.0
date: '2009-05-13T13:47:00.000-07:00'
author: headius
tags: 
modified_time: '2011-01-25T21:44:30.865-08:00'
blogger_id: tag:blogger.com,1999:blog-4704664917418794835.post-232537241269547586
blogger_orig_url: http://blog.headius.com/2009/05/jruby-nailgun-support-in-130.html
---

I've merged changes into master (to be 1.3 soon) that should make <a href="http://sourceforge.net/projects/nailgun/">Nailgun</a> easier to use. And 1.3 will be the first release to include all NG stuff in the binary dist.<br /><ul><li>jruby --ng-server starts up a server. You can manage it however you like</li><li>jruby --ng uses the Nailgun client instead of launching a new JVM for the command you run. You'll just need to run make in tool/nailgun to build the ng executable (already built for you on Windows).</li></ul>Future improvements will include having --ng start up the server for you if you haven't started it, passing signals through (don't expect signals to work at all right now), better management of threads and commands, and so on. But it's a good start, and people can try to play with it and report issues more easily now.<br /><br />Heres a sample session:<br /><pre>~/projects/jruby ➔ cd tool/nailgun/ ; make ; cd -<br />Building ng client.  To build a Windows binary, type 'make ng.exe'<br />gcc -Wall -pedantic -s -O3 -o ng src/c/ng.c<br />ld warning: option -s is obsolete and being ignored<br />/Users/headius/projects/jruby<br /><br />~/projects/jruby ➔ jruby --ng-server<br />NGServer started on all interfaces, port 2113.<br />^Z<br />[1]+  Stopped                 jruby --ng-server<br /><br />~/projects/jruby ➔ bg<br />[1]+ jruby --ng-server &amp;<br /><br />~/projects/jruby ➔ jruby --ng -e "puts 1"<br />1<br /><br />~/projects/jruby ➔ time jruby -e "puts 1"<br />1<br /><br />real    0m0.609s<br />user    0m0.482s<br />sys    0m0.119s<br /><br />~/projects/jruby ➔ time jruby --ng -e "puts 1"<br />1<br /><br />real    0m0.073s<br />user    0m0.010s<br />sys    0m0.018s</pre><br /><span style="font-weight:bold;"><span style="font-style:italic;">Update:</span></span> For those not familiar, "NailGun is a client, protocol, and server for running Java programs from the command line without incurring the JVM startup overhead. Programs run in the server (implemented in java), triggered by the client (written in C), which handles all I/O."<div><br /></div><div><b><i>Update 2:</i></b> <span>It's been brought to my attention that we no longer ship a pre-configured Makefile for the ng client, so your build command line should actually look like:</span></div><pre>~/projects/jruby ➔ cd tool/nailgun/ ; ./configure ; make ; cd -</pre><div>Alternatively, you can run "ant build-ng" in the JRuby root, which will do largely the same thing for you using Ant.</div>