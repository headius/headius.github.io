---
layout: post
title: Mongrel in JRuby?
date: '2006-06-15T11:15:00.000-07:00'
author: headius
tags: 
modified_time: '2011-01-25T21:44:34.597-08:00'
blogger_id: tag:blogger.com,1999:blog-4704664917418794835.post-4078267267620202090
blogger_orig_url: http://blog.headius.com/2006/06/mongrel-in-jruby.html
---

I'm going to try to post more frequent, less-verbose entries to break up the time between longer articles. This is the first.<br />

<br />For those of you unfamiliar with it, <a href="http://mongrel.rubyforge.org/">Mongrel</a> is a (mostly) Ruby HTTP 1.1 server, designed to escape the perils of cgi/fcgi/scgi when running web frameworks like <a href="http://rubyonrails.org/">Rails</a> or <a href="http://camping.rubyforge.org/files/README.html">Camping</a>. From what I hear it's very fast and very promising. Think of it as a Ruby equivalent to Java's servlet/web containers like <a href="http://jetty.mortbay.org/jetty/index.html">Jetty</a> and <a href="http://tomcat.apache.org/">Tomcat</a>.<br /><br />Deploying Rails apps under JRuby currently has only two reasonable outlets:<br /><br />- You can wrap all the Rails-dispatching logic into a servlet, deploying as you would a web application.<br />- You can (mostly) run the "server" script, which starts up Rails in WEBrick, Ruby's builtin lightweight server framework.<br /><br />The first option would obviously provide the best integration with existing Java code and infrastructure. The second is good for development-time testing.<br /><br />However, with JRuby rapidly becoming production-usable, there will be many folks who want a third option: deploying Rails--just Rails--in a production environment without a meaty servlet engine. For Ruby, that's where Mongrel comes in.<br /><br />Mongrel is by the developer's own admission "mostly" Ruby code. The one big area where it is not Ruby is in its HTTP parser library (there's also a native ternary search tree, but that's no big deal to reimplement). Using Mongrel, require 'http11' pulls in a C-based HTTP 1.1 parser and related utilities. Ruby is notoriously slow for parsing work, so this native code is not unreasonable. However, it would be a barrier to running Mongrel within JRuby; we would need our own native implementation of the http11 library.<br /><br />So, any takers? If I had a nickle for every JRuby sub-project I want to work on I'd have a fistful of nickles. This one will probably be pretty far back in the queue.<br /><br />Known possibilities for lightweight HTTP 1.1 support (really all that's needed for Mongrel is an HTTP1.1 library, but that can probably be used alone):<br /><br />- <a href="http://jetty.mortbay.com/jetty/index.html">Jetty</a><br />- <a href="http://simpleweb.sourceforge.net/">Simple</a><br /><br />For those of you that say "Why not just wire Rails into [Tomcat|Jetty|Simple] and be done with it" I have this answer: Rubyists are not particularly fond of Java libraries. My aim of late is working toward supporting both Ruby/Java folks who will happily marry the two and pure Ruby folks that simply want another runtime to use. Mongrel is bound to become a very popular choice for web serving Ruby applications, and we would be remiss if we did not attempt to support it.